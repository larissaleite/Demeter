{% extends "base.html" %}
{% block content %}

<div class="col-md-1">
</div>

<div class="col-md-11" ng-controller="RecipeCtrl" ng-init="init('{{ recipe.id }}','{{ current_user.id }}', '{{ user_data.is_favorite_recipe }}', '{{ user_data.rating }}')">
    <div class="row">

        <div class="col-md-4 img_box">
            <div class="recipe_img thumbnail">
                <img src="{{ recipe.img }}">
            </div>
        </div>

        <div class="col-md-8">
            <div class="recipe_title">
                <h4>{{ recipe.title }}</h4>
            </div>

            {% if recipe.rating %}
            <div class="recipe_avg">
                <p>Rating: {{ recipe.rating }}</p>
            </div>
            {% endif %}

            <div class="recipe_characteristics">
                {% for label in recipe.labels %}
                <i class="fa fa-check" aria-hidden="true"></i> {{ label }}<br>
                {% endfor %}

                <br>
                <br>

                <p>Cuisines:
                {% for cuisine in recipe.cuisines %}
                {{ cuisine }}
                {% endfor %}
                </p>
            </div>

            <br>

            <div class="recipe_ingredients">
                <p>Ingredients</p>
                {% for ingredient in recipe.ingredients %}
                <i class="fa fa-cutlery" aria-hidden="true"></i> {{ ingredient.text }}
                <br>
                {% endfor %}
            </div>

            <br>

            <div class="recipe_instructions">
                {% if recipe.instructions != None %}
                {{ recipe.instructions }}
                {% endif %}
            </div>

            <div class="row">
                <div class="col-xs-2">
                    <button class="btn btn-danger" ng-show="isFavoriteRecipe" ng-click="unfavorite('{{ recipe.id }}')"><i class="fa fa-heart" aria-hidden="true"></i> Favorited</button>
                    <button ng-show="!isFavoriteRecipe" class="btn btn-default" ng-click="favorite('{{ recipe.id }}')"><i class="fa fa-heart" aria-hidden="true"></i> Favorite</button>
                </div>
                <div class="col-xs-10">
                    <div layout="column">
                        <jk-rating-stars rating="rating" on-rating="onRating(rating)"></jk-rating-stars>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <br>

    <div class="row">
        <div class="col-xs-12">

            <h3>Comments / Reviews</h3>

            <div class="reviews" ng-show="reviews.length > 0">

                <div ng-repeat="r in reviews">

                    <hr>

                    <img class="img-circle profile-avatar-comment pull-left" src="https://graph.facebook.com/{[r.user_fb_id]}/picture">
                    <div class="comment-area">
                        <div class="delete-comment pull-right" ng-show="r.user_id == user_id"><i class="fa fa-trash-o" ng-click="delete_comment(r)"></i></div>
                        <p class="comment-description">{[ r.text ]}</p>
                        <p class="comment-date">{[ r.date ]}</p>
                    </div>
                    <div style="clear:both"></div>

                </div>

            </div><!-- .reviews -->

            <div class="empty-comments" ng-show="reviews.length == 0">
                <p class="comment-text">No reviews</p>
            </div>

            <div class="comment-area">
                <textarea cols="15" rows="3" class="form-control" ng-model="review" ng-enter="comment()"></textarea>
                <br>
                <button class="btn btn-default" ng-click="comment()">Comment</button>
            </div>

        </div>
    </div>

    {% if recipe.recommended_recipes %}
    <div class="row">
        <div class="col-xs-12">
            <h4>Similar recipes</h4>
            <div class="row">
                {% for similar_recipe in recipe.recommended_recipes %}
                <div class="col-md-3">
                    <div class="thumbnail">
                        <img src="{{ similar_recipe.image  }}" alt="...">
                        <div class="caption">
                            <p><a href="/recipe/{{ similar_recipe._id }}">{{ similar_recipe.title }}</a></p>

                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>

        </div>
    </div>
    {% endif %}

</div>


{% endblock content %}
